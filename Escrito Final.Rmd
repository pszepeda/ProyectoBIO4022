---
title: "Analisis sobre producción electrica en Sudamerica"
author: "Paulo Zepeda"
date: "10/4/2020"
output:
  pdf_document: default
  bookdown::pdf_document2:
    fig_caption: yes
    extra_dependencies: ["float"]
bibliography: Bibliografia.bib
---

```{r setup, include=FALSE, warning=F}
knitr::opts_chunk$set(echo = F)
knitr::opts_chunk$set(fig.pos = "H", out.extra = "")
options("kableExtra.html.bsTable" = T)
library(tidyverse)
library(gridExtra)
library(ggpubr)
library(knitr)
library(data.table)
library(kableExtra)
library(bookdown)
library(broom)
```


```{r Construcción de bsaes de datos preeliminar, echo=FALSE, eval=TRUE}

data1 <- read.csv(file = "Sudamerica2.csv")
dataFiltered <- select(data1, -c(quantity_footnotes))
dataFiltered <- select(dataFiltered, -1)
newNames <- c("country", "c_transaction", "year", "unit", "quantity", "category")
names(dataFiltered) <- newNames
PIB <- read.csv(file = "PIB.csv", sep = ";", header = TRUE, dec = ",")
PIBpC <-read.csv(file="PibPerCapita.csv", sep = ";", header = TRUE, dec =",")
Pob<-read.csv(file="Pob.csv",sep=";", header = TRUE, dec = ",")

#renombrar filas en Pob para que hacer coincidir los nombres de paises en ambas bases de datos

Pob[Pob == "Bolivia"] = "Bolivia (Plur. State of)"
Pob[Pob == "Brasil"] = "Brazil"
Pob[Pob == "Venezuela"] = "Venezuela (Bolivar. Rep.)"
Pob[Pob == "Trinidad y Tobago"] = "Trinidad and Tobago"

#Cambiar nombre de Pais por country

names(Pob) = c("country","year","Pob")

#Unir dos bases de datos para agregar tamaño poblacional

dataFP <-right_join(x = Pob, y= dataFiltered, by=c("country","year"))

```


# Introducción

El cambio climático ha impulsado la necesidad de cambiar la forma en que se genera electricidad a nivel mundial. Las formas contaminantes de producción como mediante la combustión de material fosil (e.g. petroleo) esta dentro de las principales causas del aumento exponencial de los gases invernadero en el siglo pasado. En este contexto, el cambio a formas de generación mas "verdes" es una de las estrategias claves en la lucha contra el cambio climatico. Dentro de estas formas encontramos las energias renovables, definidas como la energia obtenida desde flujos persistentes y repetivivos que ocurren en amnbientes locales [@twidell2015renewable]. Algunas de ellas son la energía solar, ecolica (que utiliza el viento como fuente de energía) e hidrica.

Para poder abordar esta problematica la información es vital, es por ello que el trabajo relizado por la división de estadistica de las Naciones Unidas (UNDS por sus siglas en inglés) surge como una buena herramienta para monitorear como los distintos paises se relacionan con la energía. La UNDS, todos los años genera un base de datos donde registra distintas transacciones energeticas generadas por los paises del mundo. Entre estas transacciones podemos encontrar, generación, almacenamiento, importacion, exportacion, de distintas formas de energia como solar, mareomotriz, termoelectrica, entre otras. Esta recopilación se le denomina "El cuestionario" [@Globalenergytrade].

Si buscamos realizar un analis exploratorio de esta base de datos un buen punto de partida es acotar la información. Un buen objeto de estudio es Sudamerica, esto dada la presencia de paises con variadas realidades, algunos con poblaciones muy grandes (Brasil y Argentina) y otros con poblaciones pequeñas (Ecuador y Suriname). Otro factor es las grandes diferencias en los tamaños de las economias, dato que puede tener una fuerte influencia en la cantidad de energía que se genera. Es por ello que en este trabajo se plantea como objetivo general, realizar un analisis sobre la producción de electricidad en los distintos paises de Sudamerica y tomar como caso particular a Chile, para gener un modelo para predecir la generación para los años 2015 a 2019.


**Objetivo de investigación**

- Determinar los países sudamericanos lideres en producción de electricidad según forma de generación entre los años 1991 y 2014.
- Determinar los paises sudamericanos lideres en producción de electricidad per capita entre los años 1991 y 2014.
- Generar un modelo lineal para proyectar la producción de energía años 2015-2019 para Chile, usando como variables el tamaño de la población y el PIB.


# Metodología


## Filtrar base de datos de la UNDS

La base de datos generada por la UNDS, "El Cuestionario", cuenta con mas de 1 millón de daos que recopilan información sobre el uso, almacenamiento, importación, generación de energía entre otras transacciónes. Esto para todos los paises del mundo entre los años 1990 y 2014. Dado el gran volumen de información es necesario focalizar el analisis en ciertos paises y transacciones. El objetivo de este trabajo esta centrado en paises sudamericanos, por ello el primer filtro aplicado es según paises dejando solo los siguientes:

Argentina, Bolivia, Brasil, Chile, Colombia, Ecuador, Guyana, Paraguay, Perú, Suriname, Trinidad y Tobago, Uruguay y Venezuela.

Luego el siguiente filtro esta en el tipo de energia, en este caso electrica, para evaluar solo transacciones de este tipo de energia se selecciono según "unidad", en "El cuestionario" hay datos con distintas unidades como Toneladas metricas, 
Terajoules o Kilowatt-hour, esta ultima unidad de medida esta relacionada mas con generación electrica por lo que se uso como filtro para este encontrar este tipo de transaciones. 

Para poder comparar las distintas industrias de los paises sudamericanos, se agrego el tamaño poblacional de cada pais entre 1991 y 2019, esto con la finalidad de tener una visión per capita de los niveles de producción de electricidad. La base de datos de la población por años fue obtenida de la pagina del Banco Mundial (CITA). En esta misma linea se agrego el PIB y PIB per capita, para comparar teniendo en cuenta el tamaño de las distintas economias. Los datos de PIB fueron obtenidos de la CEPAL (CITA) y el dato per capita del Banco Mundial (CITA)

## Análisis exploratorio

Como punto de partida se realizo un promedio de la producción total de energía electrica para todos los paises en el ragno de tiempo (1990-2014), el cual fue expuesto en una tabla. Seguido a esto se realizó una serie de analisis exploratorios, graficando la tendencia de producción entre los años 1990 y 2014 segun distntas variables de transación. Producción electrica total, producción electrica mediante combustible fosil, producción electrica total desde energía solar, producción electrica total desde energia eolica, producción electrica total desde energía hidrica y producción electrica total desde termogeneradoras. Todas estas fuentes de producción fueron ademas calculadas dividiendo la cantidad total por el total de población para cada año según cada pais, esto genero un per capita de producción.

## Modelo lineal para proyección de producción electrica para Chile

Se genero un modelo lineal que calculaba la cantidad de energia producida tomando como variable el PIB y la cantida de población para cada año. Luego de calculado este modelo se realizaron predicciones usando modelos de Producción total, Producción eolica y Producción mediante combustible fosil. Se incorporo como variables conocidas el PIB y tamaño poblacional entre los años 2015-2019 para asi determinar la producción (variable no conocida)

# Resultados 

## Procesamiento bases de datos

La base de datos de la UNDS cuenta con más de un millón de datos para los distintos países a escala mundial, es por ello que se realizó un filtro, enfocando así la investigación en países sudamericanos (13) específicamente en temas relacionados a Electricidad, dejando así un total de `r count(dataFiltered)` datos. Los resultados del filtro de los datos se exponen en la Figura \@ref(fig:esquema)


```{r esquema, fig.cap="Esquema filtro de datos", out.height="250px", out.width="350px",fig.align='center'}
knitr::include_graphics("ImagenMyM.png")
```

## Producción Total


El primer análisis exploratorio consistio en promediar la producción total de energia entre 1990 y 2014 para cada pais, los datos se exponen en la tabla \@ref(tab:Tabla1)


```{r confección Tabla 1, echo=F, warning= F, message=F, eval=T}
totalMainA <- dataFiltered %>% filter(c_transaction == "Electricity - total production, main activity")
Tabla <- totalMainA %>% group_by(country) %>% summarise_at("quantity", 
    .funs = list(Mean = mean, SD = sd)) %>% arrange(desc(Mean))

```

```{r Tabla1,echo=F, warning= F, message=F, eval=T}
kable(Tabla, caption="Producción Total como actividad principal por paises ", digits = 2) %>% kable_styling(bootstrap_options = c("striped", 
    "hover", "condensed"))
```

Esto se expone en la Figura \@ref(fig:Figura2) que contiene la producción total de electricidad por paises

```{r Figura2, fig.cap= "Producción total de electricidad", eval=T, echo=F, message=FALSE, warning=FALSE, fig.align='center'}

totalMainA <- dataFiltered %>% filter(c_transaction == "Electricity - total production, main activity")
plotTotalMainA <- ggplot(data=totalMainA, aes(y=quantity, x=year, color=country)) + 
  geom_line(size = 2) + ggtitle("Total Main activity") + facet_wrap(~"country", scale="free") + scale_color_manual(values = c("Chile"="#00f91d", 
  "Argentina" = "#00eef9", "Bolivia (Plur. State of)" = "#bebada", "Brazil"="#fb8072", 
  "Colombia" = "#fdb462", "Ecuador" = "#b3de69","Guyana"="#fccde5", "Paraguay" = "#d9d9d9", 
  "Peru" = "#bc80bd", "Suriname"="#ccebc5", "Trinidad and Tobago" = "black", "Uruguay" = "#ffed6f", 
  "Venezuela (Bolivar. Rep.)" = "#80b1d3")) + 
  theme(legend.position="top")

plotTotalMainA

```

Sudamerica es un continente que alberga paises con distintas realidades, es asi como brasil se empina entre los mas poblados del mundo pero en el otro extremo hay paises con escasa población. Es por esto que se estandarizo la producción total por la cantidad de individuos como se detalla en la metodología.

```{r Figura3, fig.cap= "Producción total de electricidad per capita", warning=F, fig.align='center'}



totalMainFP<- dataFP %>% filter(c_transaction == "Electricity - total production, main activity")
totalMainPC<-mutate(totalMainFP,MainPC = quantity/Pob)

plotTotalMainPC <- ggplot(data=totalMainPC, aes(y=MainPC, x=year, color=country)) + 
  geom_line(size=2) + ggtitle("Total Main Per capita") + facet_wrap(~"country", scale="free") + scale_color_manual(values = c("Chile"="#00f91d", 
  "Argentina" = "#00eef9", "Bolivia (Plur. State of)" = "#bebada", "Brazil"="#fb8072", 
  "Colombia" = "#fdb462", "Ecuador" = "#b3de69","Guyana"="#fccde5", "Paraguay" = "#d9d9d9", 
  "Peru" = "#bc80bd", "Suriname"="#ccebc5", "Trinidad and Tobago" = "black", "Uruguay" = "#ffed6f", 
  "Venezuela (Bolivar. Rep.)" = "#80b1d3")) + 
  theme(legend.position="top")

plotTotalMainPC

```

## Produccion por combustión

```{r Figura4, fig.cap="Producción de electricidad por combustibles fosiles", eval=T, echo=F, message=FALSE, warning=FALSE, fig.align='center'}

#Fuel

totalFuel<- dataFiltered %>% filter(c_transaction == "From combustible fuels – Main activity – Electricity plants")
plotTotalFuel <- ggplot(data=totalFuel, aes(y=quantity, x=year, color=country)) + 
  geom_line(size = 2) + ggtitle("Total Fuel") + facet_wrap(~"country", scale="free") + scale_color_manual(values = c("Chile"="#00f91d", 
  "Argentina" = "#00eef9", "Bolivia (Plur. State of)" = "#bebada", "Brazil"="#fb8072", 
  "Colombia" = "#fdb462", "Ecuador" = "#b3de69","Guyana"="#fccde5", "Paraguay" = "#d9d9d9", 
  "Peru" = "#bc80bd", "Suriname"="#ccebc5", "Trinidad and Tobago" = "black", "Uruguay" = "#ffed6f", 
  "Venezuela (Bolivar. Rep.)" = "#80b1d3")) +
  theme(legend.position="top")

plotTotalFuel


```

```{r Figura5,  fig.cap="Producción de electricidad por combustibles fosiles per capita", eval=T, echo=F, message=FALSE, warning=FALSE, fig.align='center'}

totalFuelFP<- dataFP %>% filter(c_transaction == "From combustible fuels – Main activity – Electricity plants")
totalFuelPC<-mutate(totalFuelFP,FuelPC = quantity/Pob)
plotTotalFuelPC <- ggplot(data=totalFuelPC, aes(y=FuelPC, x=year, color=country)) + 
  geom_line(size=2) + ggtitle("Total FuelPC") + facet_wrap(~"country", scale="free") +  scale_color_manual(values = c("Chile"="#00f91d", 
  "Argentina" = "#00eef9", "Bolivia (Plur. State of)" = "#bebada", "Brazil"="#fb8072", 
  "Colombia" = "#fdb462", "Ecuador" = "#b3de69","Guyana"="#fccde5", "Paraguay" = "#d9d9d9", 
  "Peru" = "#bc80bd", "Suriname"="#ccebc5", "Trinidad and Tobago" = "black", "Uruguay" = "#ffed6f", 
  "Venezuela (Bolivar. Rep.)" = "#80b1d3")) + theme(legend.position="top")

plotTotalFuelPC

```


## Producción total distintas fuentes

```{r conf Figura 6, eval=T, echo=F, message=FALSE, warning=FALSE, fig.align='center'}

#Wind

totalWind<- dataFiltered %>% filter(c_transaction == "Electricity - total wind production")
plotTotalWind <- ggplot(data=totalWind, aes(y=quantity, x=year, color=country)) + 
  geom_line(size = 2) + ggtitle("Total Wind") + facet_wrap(~"country", scale="free") + scale_color_manual(values = c("Chile"="#00f91d", 
  "Argentina" = "#00eef9", "Bolivia (Plur. State of)" = "#bebada", "Brazil"="#fb8072", 
  "Colombia" = "#fdb462", "Ecuador" = "#b3de69","Guyana"="#fccde5", "Paraguay" = "#d9d9d9", 
  "Peru" = "#bc80bd", "Suriname"="#ccebc5", "Trinidad and Tobago" = "black", "Uruguay" = "#ffed6f", 
  "Venezuela (Bolivar. Rep.)" = "#80b1d3")) +
  theme(legend.position="top")
#Wind Main activity

WindMA<- dataFiltered %>% filter(c_transaction == "Wind - Main activity")
plotWindMA <- ggplot(data=totalWind, aes(y=quantity, x=year, color=country)) + 
  geom_line(size = 2) + ggtitle("Wind Main activity") + facet_wrap(~"country", scale="free") + scale_color_manual(values = c("Chile"="#00f91d", 
  "Argentina" = "#00eef9", "Bolivia (Plur. State of)" = "#bebada", "Brazil"="#fb8072", 
  "Colombia" = "#fdb462", "Ecuador" = "#b3de69","Guyana"="#fccde5", "Paraguay" = "#d9d9d9", 
  "Peru" = "#bc80bd", "Suriname"="#ccebc5", "Trinidad and Tobago" = "black", "Uruguay" = "#ffed6f", 
  "Venezuela (Bolivar. Rep.)" = "#80b1d3")) + 
  theme(legend.position="top")

#Wind PC

totalWindFP<- dataFP %>% filter(c_transaction == "Electricity - total wind production")
totalWindPC<-mutate(totalWindFP,WindPC = quantity/Pob)
plotTotalWindPC <- ggplot(data=totalWindPC, aes(y=WindPC, x=year, color=country)) + 
  geom_line(size=2) + ggtitle("Total WindPC") + facet_wrap(~"country", scale="free") +  scale_color_manual(values = c("Chile"="#00f91d", 
  "Argentina" = "#00eef9", "Bolivia (Plur. State of)" = "#bebada", "Brazil"="#fb8072", 
  "Colombia" = "#fdb462", "Ecuador" = "#b3de69","Guyana"="#fccde5", "Paraguay" = "#d9d9d9", 
  "Peru" = "#bc80bd", "Suriname"="#ccebc5", "Trinidad and Tobago" = "black", "Uruguay" = "#ffed6f", 
  "Venezuela (Bolivar. Rep.)" = "#80b1d3")) + theme(legend.position="top")

#Solar

totalSolar<- dataFiltered %>% filter(c_transaction == "Electricity - total solar production")
plotTotalSolar <- ggplot(data=totalSolar, aes(y=quantity, x=year, color=country)) + 
  geom_line(size = 2) + ggtitle("Total Solar") + facet_wrap(~"country", scale="free") + scale_color_manual(values = c("Chile"="#00f91d", 
  "Argentina" = "#00eef9", "Bolivia (Plur. State of)" = "#bebada", "Brazil"="#fb8072", 
  "Colombia" = "#fdb462", "Ecuador" = "#b3de69","Guyana"="#fccde5", "Paraguay" = "#d9d9d9", 
  "Peru" = "#bc80bd", "Suriname"="#ccebc5", "Trinidad and Tobago" = "black", "Uruguay" = "#ffed6f", 
  "Venezuela (Bolivar. Rep.)" = "#80b1d3")) +
  theme(legend.position="top")

SolarPV<- dataFiltered %>% filter(c_transaction == "Solar photovoltaic – Main activity")
plotSolarPV <- ggplot(data=SolarPV, aes(y=quantity, x=year, color=country)) + 
  geom_line() + ggtitle("Solar photovoltaic") + facet_wrap(~"country", scale="free") + 
  theme(legend.position="top")

SolarT<- dataFiltered %>% filter(c_transaction == "Solar thermal – Main activity")
plotSolarT <- ggplot(data=SolarT, aes(y=quantity, x=year, color=country)) + 
  geom_line() + ggtitle("Solar Thermal") + facet_wrap(~"country", scale="free") + 
  theme(legend.position="top")

#Solar PC

totalSolarFP<- dataFP %>% filter(c_transaction == "Electricity - total solar production")
totalSolarPC<-mutate(totalSolarFP,SolarPC = quantity/Pob)
plotTotalSolarPC <- ggplot(data=totalSolarPC, aes(y=SolarPC, x=year, color=country)) + 
  geom_line(size=2) + ggtitle("Total SolarPC") + facet_wrap(~"country", scale="free") +  scale_color_manual(values = c("Chile"="#00f91d", 
  "Argentina" = "#00eef9", "Bolivia (Plur. State of)" = "#bebada", "Brazil"="#fb8072", 
  "Colombia" = "#fdb462", "Ecuador" = "#b3de69","Guyana"="#fccde5", "Paraguay" = "#d9d9d9", 
  "Peru" = "#bc80bd", "Suriname"="#ccebc5", "Trinidad and Tobago" = "black", "Uruguay" = "#ffed6f", 
  "Venezuela (Bolivar. Rep.)" = "#80b1d3")) + theme(legend.position="top")


#Hydro

totalHydro<- dataFiltered %>% filter(c_transaction == "Electricity - total hydro production")
plotTotalHydro <- ggplot(data=totalHydro, aes(y=quantity, x=year, color=country)) + 
  geom_line(size = 2) + ggtitle("Total Hydro") + facet_wrap(~"country", scale="free") + scale_color_manual(values = c("Chile"="#00f91d", 
  "Argentina" = "#00eef9", "Bolivia (Plur. State of)" = "#bebada", "Brazil"="#fb8072", 
  "Colombia" = "#fdb462", "Ecuador" = "#b3de69","Guyana"="#fccde5", "Paraguay" = "#d9d9d9", 
  "Peru" = "#bc80bd", "Suriname"="#ccebc5", "Trinidad and Tobago" = "black", "Uruguay" = "#ffed6f", 
  "Venezuela (Bolivar. Rep.)" = "#80b1d3")) +
  theme(legend.position="top")
#Hidro PC

totalHydroFP<- dataFP %>% filter(c_transaction == "Electricity - total hydro production")
totalHydroPC<-mutate(totalHydroFP,HydroPC = quantity/Pob)
plotTotalHydroPC <- ggplot(data=totalHydroPC, aes(y=HydroPC, x=year, color=country)) + 
  geom_line(size=2) + ggtitle("Total HydroPC") + facet_wrap(~"country", scale="free") +  scale_color_manual(values = c("Chile"="#00f91d", 
  "Argentina" = "#00eef9", "Bolivia (Plur. State of)" = "#bebada", "Brazil"="#fb8072", 
  "Colombia" = "#fdb462", "Ecuador" = "#b3de69","Guyana"="#fccde5", "Paraguay" = "#d9d9d9", 
  "Peru" = "#bc80bd", "Suriname"="#ccebc5", "Trinidad and Tobago" = "black", "Uruguay" = "#ffed6f", 
  "Venezuela (Bolivar. Rep.)" = "#80b1d3")) + theme(legend.position="top")
#Thermal

totalThermal<- dataFiltered %>% filter(c_transaction == "Electricity - total thermal production")
plotTotalThermal <- ggplot(data=totalThermal, aes(y=quantity, x=year, color=country)) + 
  geom_line(size = 2) + ggtitle("Total Thermal") + facet_wrap(~"country", scale="free") + scale_color_manual(values = c("Chile"="#00f91d", 
  "Argentina" = "#00eef9", "Bolivia (Plur. State of)" = "#bebada", "Brazil"="#fb8072", 
  "Colombia" = "#fdb462", "Ecuador" = "#b3de69","Guyana"="#fccde5", "Paraguay" = "#d9d9d9", 
  "Peru" = "#bc80bd", "Suriname"="#ccebc5", "Trinidad and Tobago" = "black", "Uruguay" = "#ffed6f", 
  "Venezuela (Bolivar. Rep.)" = "#80b1d3")) +
  theme(legend.position="top")

#Thermal PC

totalThermalFP<- dataFP %>% filter(c_transaction == "Electricity - total thermal production")
totalThermalPC<-mutate(totalThermalFP,ThermalPC = quantity/Pob)
plotTotalThermalPC <- ggplot(data=totalThermalPC, aes(y=ThermalPC, x=year, color=country)) + 
  geom_line(size=2) + ggtitle("Total ThermalPC") + facet_wrap(~"country", scale="free") +  scale_color_manual(values = c("Chile"="#00f91d", 
  "Argentina" = "#00eef9", "Bolivia (Plur. State of)" = "#bebada", "Brazil"="#fb8072", 
  "Colombia" = "#fdb462", "Ecuador" = "#b3de69","Guyana"="#fccde5", "Paraguay" = "#d9d9d9", 
  "Peru" = "#bc80bd", "Suriname"="#ccebc5", "Trinidad and Tobago" = "black", "Uruguay" = "#ffed6f", 
  "Venezuela (Bolivar. Rep.)" = "#80b1d3")) + theme(legend.position="top")



```


```{r Figura6,  fig.cap="Producción de electricidad por distintas fuentes", eval=T, echo=F, message=FALSE, warning=FALSE, fig.align='center'}
Figure6 <- ggarrange(plotTotalHydro, plotTotalSolar,plotTotalWind, plotTotalThermal + rremove("x.text"), 
          labels = c("A", "B", "C","D"), common.legend = T, legend = "bottom",
          ncol = 2, nrow = 2)
Figure6
```

```{r Figura7,  fig.cap="Producción de electricidad por distintas fuentes per capita", eval=T, echo=F, message=FALSE, warning=FALSE, fig.align='center'}

Figure7 <-ggarrange(plotTotalHydroPC, plotTotalSolarPC,plotTotalWindPC, plotTotalThermalPC + rremove("x.text"), 
          labels = c("A", "B", "C","D"), common.legend = T, legend = "bottom",
          ncol = 2, nrow = 2)+ scale_color_manual(values = c("Chile"="#00f91d", 
  "Argentina" = "#00eef9", "Bolivia (Plur. State of)" = "#bebada", "Brazil"="#fb8072", 
  "Colombia" = "#fdb462", "Ecuador" = "#b3de69","Guyana"="#fccde5", "Paraguay" = "#d9d9d9", 
  "Peru" = "#bc80bd", "Suriname"="#ccebc5", "Trinidad and Tobago" = "black", "Uruguay" = "#ffed6f", 
  "Venezuela (Bolivar. Rep.)" = "#80b1d3"))

Figure7
```



## Modelo

Modelo lineal para estimar la producción total de electricidad ademas de la produccion mediante metodos especificos como solar, eolica, hidrica y termal.

Siguiente ejemplo es un modelo inicial para produción total Solar para Chile estimando año 2015 

```{r Generación Modelos, echo=FALSE, eval=T, cache=FALSE}

#Las bases de datos que se usaran para el modelo deberia ser dataFP mas PIB per CAPITA y PIB

PIB<-read.csv(file="PIB.csv",sep=";", header = TRUE, dec = ",")

#renombrar filas en Pob para que hacer coincidir los nombres de paises en ambas bases de datos


PIB[PIB == "Bolivia"] = "Bolivia (Plur. State of)"
PIB[PIB == "Brasil"] = "Brazil"
PIB[PIB == "Venezuela"] = "Venezuela (Bolivar. Rep.)"
PIB[PIB == "Trinidad y Tobago"] = "Trinidad and Tobago"

#unir con la tabla dataFP + PIB

dataB <-right_join(x = PIB, y= dataFiltered, by=c("country","year"))
dataC <-right_join(x = Pob, y= dataB, by=c("country","year"))


# separar base de datos por tipos de producción

totalMaModelo<- dataC%>% filter(c_transaction == "Electricity - total production, main activity")
totalWindModelo<- dataC %>% filter(c_transaction == "Electricity - total wind production")
totalFuelModelo<- dataC %>% filter(c_transaction == "From combustible fuels – Main activity – Electricity plants")

#Individualizar datos de Chile

ChileTotal <- totalMaModelo%>% filter(country == "Chile")
ChileWind <- totalWindModelo%>% filter(country == "Chile")
ChileFuel <- totalFuelModelo%>% filter(country == "Chile")

#Modelos Chile


ModeloTotalChile <- lm(quantity~ Pob + Total, data = ChileTotal)


fitModeloTC <- fitted.values(ModeloTotalChile)

año2015 <- data.frame(Pob=17969353, Total=243919000000)
año2016 <- data.frame(Pob=18209068, Total=250440000000)
año2017 <- data.frame(Pob=18470439, Total=277045000000)
año2018 <- data.frame(Pob=18729160, Total=298258000000)
año2019 <- data.frame(Pob=18952038, Total=282318000000)


pMa1 = predict(ModeloTotalChile, año2015, interval = "confidence", level=0.95)
pMa2 = predict(ModeloTotalChile, año2016, interval = "confidence", level=0.95)
pMa3 = predict(ModeloTotalChile, año2017, interval = "confidence", level=0.95)
pMa4 = predict(ModeloTotalChile, año2018, interval = "confidence", level=0.95)
pMa5 = predict(ModeloTotalChile, año2019, interval = "confidence", level=0.95)

ModeloVientoChile <-lm(quantity~ Pob + Total, data = ChileWind)

pVi1 = predict(ModeloVientoChile, año2015, interval = "confidence", level=0.95)
pVi2 = predict(ModeloVientoChile, año2016, interval = "confidence", level=0.95)
pVi3 = predict(ModeloVientoChile, año2017, interval = "confidence", level=0.95)
pVi4 = predict(ModeloVientoChile, año2018, interval = "confidence", level=0.95)
pVi5 = predict(ModeloVientoChile, año2019, interval = "confidence", level=0.95)

ModeloCombChile <-lm(quantity~ Pob + Total, data = ChileFuel)

pCo1 = predict(ModeloCombChile, año2015, interval = "confidence", level=0.95)
pCo2 = predict(ModeloCombChile, año2016, interval = "confidence", level=0.95)
pCo3 = predict(ModeloCombChile, año2017, interval = "confidence", level=0.95)
pCo4 = predict(ModeloCombChile, año2018, interval = "confidence", level=0.95)
pCo5 = predict(ModeloCombChile, año2019, interval = "confidence", level=0.95)


TablapMa1 <- data.table(pMa1)
TablapMa2 <- data.table(pMa2)
TablapMa3 <- data.table(pMa3)
TablapMa4 <- data.table(pMa4)
TablapMa5 <- data.table(pMa5)

#TablaMa<- merge(TablapMa1, TablapMa2, TablapMa3, TablapMa4, TablapMa5)


TablaMa = rbind(TablapMa1, TablapMa2, TablapMa3, TablapMa4, TablapMa5)


TablapVi1 <- data.table(pVi1)
TablapVi2 <- data.table(pVi2)
TablapVi3 <- data.table(pVi3)
TablapVi4 <- data.table(pVi4)
TablapVi5 <- data.table(pVi5)

TablaVi = rbind(TablapVi1, TablapVi2, TablapVi3, TablapVi4, TablapVi5)

TablapCo1 <- data.table(pCo1)
TablapCo2 <- data.table(pCo2)
TablapCo3 <- data.table(pCo3)
TablapCo4 <- data.table(pCo4)
TablapCo5 <- data.table(pCo5)

TablaCo = rbind(TablapCo1, TablapCo2, TablapCo3, TablapCo4, TablapCo5)

```

```{r tablaMa, echo=F, eval=T, cache=FALSE}


colyears <- data.frame("Años" = c(2015, 2016, 2017, 2018, 2019))
tabla2b = cbind(colyears,TablaMa)


kable(tabla2b, caption="Proyecciones Modelo Actividad", digits = 2) %>% kable_styling(bootstrap_options = c("striped", 
    "hover", "condensed"))
```

```{r tablaVi, echo=F, eval=T, cache=FALSE}
tabla3b = cbind(colyears,TablaVi)

kable(tabla3b, caption="Proyecciones Modelo Producción Eolica", digits = 2) %>% kable_styling(bootstrap_options = c("striped", 
    "hover", "condensed"))
```

```{r tablaCo, echo=F, eval=T, cache=FALSE}
tabla4b = cbind(colyears,TablaCo)
kable(tabla4b, caption="Proyecciones Modelo Producción por combustible", digits = 2) %>% kable_styling(bootstrap_options = c("striped", 
    "hover", "condensed"))
```



# Discusión

- Los mayores productores de electricidad en la región son Brasil, Venezuela y Argentina.
- Algunas tecnologías como la producción solar o mediante viento aparecen como factor relevante bien avanzado los 2000 y solo en algunos países.
- En el caso de la producción de energía mediante radiación solar Chile presenta un liderazgo notable con un claro aumento desde 2013.

# Conclusión


En términos de producción total de energía eléctrica Sudamérica tiene claros lideres, Brasil, Venezuela y Argentina. Pero con el cambio a la producción con energías renovables aparecen nuevos lideres como Chile en términos de generación Solar

# Referencias
